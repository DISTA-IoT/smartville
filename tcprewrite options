tcprewrite 

-b, --skipbroadcast

Skip rewriting broadcast/multicast IPv4/v6 addresses.

By default --seed, --pnat and --endpoints will rewrite broadcast and multicast IPv4/v6 and MAC addresses. Setting this flag will keep broadcast/multicast IPv4/v6 and MAC addresses from being rewritten.


-e string, --endpoints=string

Rewrite IP addresses to be between two endpoints. This option may appear up to 1 times. This option must appear in combination with the following options: cachefile.

Takes a pair of colon delimited IPv4/v6 addresses which will be used to rewrite all traffic to appear to be between the two IP addresses.

IPv4 Example:
--endpoints=172.16.0.1:172.16.0.2
IPv6 Example:
--endpoints=[2001:db8::dead:beef]:[::ffff:0:0:ac:f:0:2]

-v, --verbose

Print decoded packets via tcpdump to STDOUT. This option may appear up to 1 times.

-A string, --decode=string

Arguments passed to tcpdump decoder. This option may appear up to 1 times. This option must appear in combination with the following options: verbose.

When enabling verbose mode (-v) you may also specify one or more additional arguments to pass to tcpdump to modify the way packets are decoded. By default, -n and -l are used. Be sure to quote the arguments like: -A "-axxx" so that they are not interpreted by tcpreplay. Please see the tcpdump(1) man page for a complete list of options.


-K, --preload-pcap

Preloads packets into RAM before sending.

This option loads the specified pcap(s) into RAM before starting to send in order to improve replay performance while introducing a startup performance hit. Preloading can be used with or without --loop. This option also suppresses flow statistics collection for every iteration, which can significantly reduce memory usage. Flow statistics are predicted based on options supplied and statistics collected from the first loop iteration.


-l number, --loop=number

Loop through the capture file X times. This option may appear up to 1 times. This option takes an integer number as its argument. The value of number is constrained to being:

greater than or equal to 0

The default number for this option is:
1

--loopdelay-ms=number

Delay between loops in milliseconds. This option must appear in combination with the following options: loop. This option takes an integer number as its argument. The value of number is constrained to being:

greater than or equal to 0

The default number for this option is:
0

--no-flow-stats

Suppress printing and tracking flow count, rates and expirations.

Suppress the collection and printing of flow statistics. This option may improve performance when not using --preload-pcap option, otherwise its only function is to suppress printing.

The flow feature will track and print statistics of the flows being sent. A flow is loosely defined as a unique combination of a 5-tuple, i.e. source IP, destination IP, source port, destination port and protocol.

If --loop is specified, the flows from one iteration to the next will not be unique, unless the packets are altered. Use --unique-ip or tcpreplay-edit to alter packets between iterations.

-P, --pid

Print the PID of tcpreplay at startup.

--stats=number

Print statistics every X seconds, or every loop if ’0’. This option takes an integer number as its argument. The value of number is constrained to being:

greater than or equal to 0

Note that timed delays are a "best effort" and long delays between sending packets may cause equally long delays between printing statistics.



--enet-smac=string

Override source ethernet MAC addresses. This option may appear up to 1 times.

Takes a pair of comma deliminated ethernet MAC addresses which will replace the source MAC address of outbound packets. The first MAC address will be used for the server to client traffic and the optional second MAC address will be used for the client to server traffic.

Example:
--enet-smac=00:12:13:14:15:16,00:22:33:44:55:66


potremmo giocare con questo parametro:

--tos=number

Set the IPv4 TOS/DiffServ/ECN byte. This option may appear up to 1 times. This option takes an integer number as its argument. The value of number is constrained to being:

in the range 0 through 255

Allows you to override the TOS (also known as DiffServ/ECN) value in IPv4.

